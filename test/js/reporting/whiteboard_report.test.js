import {assert} from 'chai';
import 'jsdom-global/register'
var jsdom = require('jsdom')
import whiteboardReport  from '../../../web/static/js/reporting/whiteboard_report';

var defaultHtml = '<!doctype html><html><head><meta charset="utf-8">' +
  '</head><body> <svg class="whiteboard"></svg> </body></html>'

describe("test Whiteboard report", () => {
  var json = "[{\"id\":\"ellipseSiqj6ksgd84\",\"element\":{\"type\":\"ellipse\",\"attr\":{\"transform\":\"matrix(1,0.0017,-0.0017,1,0.3252,-0.3238)\",\"style\":\"stroke-width: 2;\",\"stroke\":\"#e51e39\",\"ry\":\"62\",\"rx\":\"33\",\"fill\":\"#e51e39\",\"cy\":\"186.1875\",\"cx\":\"185.671875\"}},\"action\":\"draw\"},{\"id\":\"lineSiqj6ksgd92\",\"element\":{\"type\":\"line\",\"attr\":{\"y2\":\"331.1875\",\"y1\":\"245.1875\",\"x2\":\"321.671875\",\"x1\":\"403.671875\",\"transform\":\"matrix(1,0.0017,-0.0017,1,0.5776,-0.56)\",\"style\":\"stroke-width: 2;\",\"stroke\":\"#e51e39\",\"fill\":\"#e51e39\"}},\"action\":\"draw\"},{\"id\":\"rectSiqj6ksgda0\",\"element\":{\"type\":\"rect\",\"attr\":{\"y\":\"62.1875\",\"x\":\"452.671875\",\"width\":\"31\",\"transform\":\"matrix(1,0.0017,-0.0017,1,0.118,-0.7987)\",\"style\":\"stroke-width: 4;\",\"stroke\":\"#e51e39\",\"height\":\"38\",\"fill\":\"#e51e39\"}},\"action\":\"draw\"},{\"id\":\"polylineSiqj6ksgdb6\",\"element\":{\"type\":\"polyline\",\"attr\":{\"transform\":\"matrix(1,0.0017,-0.0017,1,0,0)\",\"style\":\"stroke-width: 4;\",\"stroke\":\"#e51e39\",\"points\":\"302.671875,161.1875,304.671875,164.1875,306.671875,166.1875,307.671875,168.1875,309.671875,169.1875,312.671875,172.1875,313.671875,173.1875,315.671875,174.1875,316.671875,174.1875,317.671875,175.1875,321.671875,177.1875,322.671875,178.1875,324.671875,178.1875,326.671875,179.1875,327.671875,179.1875,329.671875,180.1875,330.671875,180.1875,331.671875,180.1875,332.671875,180.1875,335.671875,180.1875,337.671875,179.1875,340.671875,176.1875,341.671875,175.1875,342.671875,174.1875,343.671875,172.1875,343.671875,170.1875,343.671875,167.1875,343.671875,165.1875,343.671875,161.1875,343.671875,157.1875,343.671875,150.1875,343.671875,143.1875,343.671875,139.1875,343.671875,134.1875,343.671875,131.1875,342.671875,130.1875,341.671875,129.1875,340.671875,129.1875,339.671875,131.1875,338.671875,133.1875,337.671875,136.1875,336.671875,139.1875,334.671875,142.1875,333.671875,146.1875,330.671875,151.1875,326.671875,157.1875,321.671875,163.1875,315.671875,170.1875,311.671875,176.1875,307.671875,182.1875,303.671875,186.1875,303.671875,187.1875\",\"fill\":\"none\"}},\"action\":\"draw\"},{\"id\":\"polylineSiqj6ksgdc4\",\"element\":{\"type\":\"polyline\",\"attr\":{\"transform\":\"matrix(1,0.0017,-0.0017,1,0,0)\",\"style\":\"stroke-width: 4;\",\"stroke\":\"#e51e39\",\"points\":\"443.671875,203.1875,447.671875,209.1875,449.671875,213.1875,450.671875,217.1875,450.671875,218.1875,450.671875,219.1875,451.671875,220.1875,452.671875,221.1875,453.671875,222.1875,454.671875,223.1875,456.671875,223.1875,457.671875,224.1875,458.671875,224.1875,459.671875,224.1875,461.671875,222.1875,462.671875,222.1875,463.671875,221.1875,464.671875,220.1875,466.671875,219.1875,467.671875,218.1875,467.671875,217.1875,467.671875,216.1875,468.671875,214.1875,468.671875,213.1875,469.671875,212.1875,469.671875,211.1875,470.671875,210.1875,470.671875,208.1875,470.671875,206.1875,470.671875,205.1875,470.671875,203.1875,470.671875,202.1875,470.671875,201.1875,472.671875,199.1875,472.671875,198.1875,472.671875,197.1875,472.671875,195.1875,472.671875,191.1875,473.671875,187.1875,474.671875,182.1875,474.671875,175.1875,474.671875,168.1875,474.671875,164.1875,474.671875,159.1875,474.671875,153.1875,474.671875,152.1875,472.671875,148.1875,471.671875,147.1875,470.671875,146.1875,468.671875,145.1875,466.671875,145.1875,465.671875,145.1875,463.671875,145.1875,462.671875,145.1875,460.671875,145.1875,458.671875,145.1875,456.671875,145.1875,453.671875,145.1875,447.671875,145.1875,440.671875,145.1875,430.671875,145.1875,421.671875,145.1875,412.671875,145.1875,403.671875,145.1875,395.671875,145.1875,390.671875,145.1875,386.671875,145.1875,383.671875,146.1875\",\"fill\":\"#e51e39\"}},\"action\":\"draw\"},{\"id\":\"lineSiqj6ksgdd2\",\"element\":{\"type\":\"line\",\"attr\":{\"y2\":\"186.1875\",\"y1\":\"262.1875\",\"x2\":\"622.671875\",\"x1\":\"519.671875\",\"transform\":\"matrix(1,0.0017,-0.0017,1,0.325,-1.0856)\",\"style\":\"stroke-width: 4;\",\"stroke\":\"#e51e39\",\"fill\":\"#e51e39\"}},\"action\":\"draw\"},{\"id\":\"lineSiqj6ksgde0\",\"element\":{\"type\":\"line\",\"attr\":{\"y2\":\"335.1875\",\"y1\":\"332.1875\",\"x2\":\"61.671875\",\"x1\":\"150.671875\",\"transform\":\"matrix(1,0.0017,-0.0017,1,0.5842,-0.1063)\",\"style\":\"marker-start: url(\\\"#markerSiqj6ksgde3\\\"); stroke-width: 4;\",\"stroke\":\"#e51e39\",\"fill\":\"#e51e39\"}},\"action\":\"draw\"},{\"id\":\"textSiqj6ksgdgu\",\"element\":{\"type\":\"text\",\"childNodes\":[{\"type\":\"#text\",\"attr\":{\"text\":\"kautkas\"}}],\"attr\":{\"y\":\"230\",\"x\":\"475\",\"transform\":\"matrix(1,0.0017,-0.0017,1,56.3935,-163.8708)\",\"textVal\":\"kautkas\",\"style\":\"stroke-width: 4; font-size: 40px;\",\"stroke\":\"#e51e39\",\"fill\":\"#e51e39\"}},\"action\":\"draw\"},{\"id\":\"imageSiqj6m3m46q\",\"element\":{\"type\":\"image\",\"attr\":{\"y\":\"20\",\"x\":\"10\",\"width\":\"200\",\"transform\":\"matrix(1,0.0017,-0.0017,1,541.1223,199.8081)\",\"preserveAspectRatio\":\"none\",\"href\":\"http://localhost:3000/uploads/images/3/original_dasdsad.jpg?v=63635530459\",\"height\":\"100\"}},\"action\":\"draw\"}]"

  describe("element adding.", () => {
    before(() => {
      var document = jsdom.jsdom(defaultHtml)
      window = document.defaultView
      window.Snap = require('snapsvg');
      window.$ = require('jquery')
    })

    it("Add elements to svg class", () => {
      whiteboardReport.drawElements(JSON.parse(json))
      assert.equal(window.$("svg.whiteboard").children().length, 11);
    });
  });
});
